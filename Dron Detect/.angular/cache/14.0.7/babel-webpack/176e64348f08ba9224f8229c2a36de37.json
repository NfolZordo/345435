{"ast":null,"code":"import * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common\";\nconst _c0 = [\"myCanvas\"];\n\nfunction AppComponent_div_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 2)(1, \"div\", 3)(2, \"div\", 4);\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd()()();\n  }\n\n  if (rf & 2) {\n    const x_r2 = ctx.$implicit;\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate1(\"\\u0412\\u0456\\u0434\\u0441\\u0442\\u0430\\u043D\\u044C \\u0434\\u043E \\u0440\\u0430\\u0434\\u0430\\u0440\\u0430 \", x_r2, \"\");\n  }\n}\n\nexport let AppComponent = /*#__PURE__*/(() => {\n  class AppComponent {\n    constructor() {\n      this.infoRadars = [];\n      this.droneNumber = 0;\n    }\n\n    ngAfterViewInit() {\n      const canvas = this.myCanvas.nativeElement;\n      const context = this.myCanvas.nativeElement.getContext('2d');\n      canvas.width = 1000;\n      canvas.height = 800;\n      let mouse = {\n        x: 0,\n        y: 0\n      };\n      let draw = false;\n      const radar1 = {\n        x: 100,\n        y: 80\n      };\n      const radar2 = {\n        x: 650,\n        y: 80\n      };\n      const radar3 = {\n        x: 100,\n        y: 650\n      };\n      const radar4 = {\n        x: 650,\n        y: 650\n      };\n\n      for (let x = 0.5; x < canvas.width; x += 10) {\n        context.moveTo(x, 0);\n        context.lineTo(x, canvas.height);\n      }\n\n      for (let y = 0.5; y < canvas.height; y += 10) {\n        context.moveTo(0, y);\n        context.lineTo(canvas.width, y);\n      }\n\n      context.stroke();\n      context.beginPath();\n      context.arc(radar1.x, radar1.y, 6, 0, Math.PI * 2);\n      console.log(typeof radar1);\n      context.fillStyle = \"green\";\n      context.fill();\n      context.closePath();\n      context.stroke();\n      context.stroke();\n      context.beginPath();\n      context.arc(radar2.x, radar2.y, 6, 0, Math.PI * 2);\n      context.fillStyle = \"green\";\n      context.fill();\n      context.closePath();\n      context.stroke();\n      context.stroke();\n      context.beginPath();\n      context.arc(radar3.x, radar3.y, 6, 0, Math.PI * 2);\n      context.fillStyle = \"green\";\n      context.fill();\n      context.closePath();\n      context.stroke();\n      context.stroke();\n      context.beginPath();\n      context.arc(radar4.x, radar4.y, 6, 0, Math.PI * 2);\n      context.fillStyle = \"green\";\n      context.fill();\n      context.closePath();\n      context.stroke();\n      canvas.addEventListener(\"mouseup\", function (e) {\n        mouse.x = e.pageX - this.offsetLeft;\n        mouse.y = e.pageY - this.offsetTop;\n        context.beginPath();\n        let dron = context.arc(mouse.x, mouse.y, 4, 0, Math.PI * 2, false);\n        context.fillStyle = \"red\";\n        context.fill();\n        context.stroke();\n        context.closePath();\n        draw = false;\n        console.log(\"---1 \");\n        addElement(calculateDistance(radar1, radar2, mouse), calculateAngle(mouse, radar1));\n        addElement(calculateDistance(radar2, radar4, mouse), calculateAngle(mouse, radar2));\n        addElement(calculateDistance(radar3, radar1, mouse), calculateAngle(mouse, radar3));\n        addElement(calculateDistance(radar4, radar3, mouse), calculateAngle(mouse, radar4));\n        console.log(\"Радар 1 = \" + calculateDistance(radar1, radar2, mouse));\n        console.log(\"Азимут 1 = \" + calculateAngle(mouse, radar1));\n        console.log(\" \");\n        console.log(\"Радар 2 = \" + calculateDistance(radar2, radar4, mouse));\n        console.log(\"Азимут 2 = \" + calculateAngle(mouse, radar2));\n        console.log(\" \");\n        console.log(\"Радар 3 = \" + calculateDistance(radar3, radar1, mouse));\n        console.log(\"Азимут 3 = \" + calculateAngle(mouse, radar3));\n        console.log(\" \");\n        console.log(\"Радар 4 = \" + calculateDistance(radar4, radar3, mouse));\n        console.log(\"Азимут 4 = \" + calculateAngle(mouse, radar4));\n      });\n\n      function addElement(distanceRadar, angleRadar) {\n        console.log(\"--- 2.1 \" + distanceRadar);\n        console.log(\"--- 2.2 \" + angleRadar);\n        this?.infoRadars?.push(new InfoRadar(distanceRadar, angleRadar));\n        console.log(\"--- 3\");\n      }\n\n      function calculateAngle(dronСoordinates, radarСoordinates) {\n        let azimuth;\n        let angle;\n        angle = Math.atan((dronСoordinates.y - radarСoordinates.y) / (dronСoordinates.x - radarСoordinates.x)) * 180 / Math.PI;\n\n        if (dronСoordinates.x >= radarСoordinates.x) {\n          azimuth = 90 + angle;\n        } else {\n          azimuth = 270 + angle;\n        }\n\n        return azimuth;\n      }\n\n      function calculateTriangleAngle(radarСoordinates1, radarСoordinates2, dronСoordinates) {\n        let angle;\n        let side1 = Math.sqrt(Math.pow(radarСoordinates2.y - radarСoordinates1.y, 2) + Math.pow(radarСoordinates2.x - radarСoordinates1.x, 2));\n        let side2 = Math.sqrt(Math.pow(dronСoordinates.y - radarСoordinates1.y, 2) + Math.pow(dronСoordinates.x - radarСoordinates1.x, 2));\n        let side3 = Math.sqrt(Math.pow(dronСoordinates.y - radarСoordinates2.y, 2) + Math.pow(dronСoordinates.x - radarСoordinates2.x, 2));\n        angle = Math.acos((side2 * side2 + side3 * side3 - side1 * side1) / (2 * side2 * side3)) * 180 / Math.PI;\n        return angle;\n      }\n\n      function calculateDistance(radarСoordinates1, radarСoordinates2, dronСoordinates) {\n        let distance;\n        let angleRadar1 = calculateTriangleAngle(dronСoordinates, radarСoordinates1, radarСoordinates2);\n        let angleRadar2 = calculateTriangleAngle(dronСoordinates, radarСoordinates2, radarСoordinates1);\n        let angleThird = 180 - angleRadar1 - angleRadar2;\n        let distanceBetweenRadars = Math.sqrt(Math.pow(radarСoordinates1.x - radarСoordinates2.x, 2) + Math.pow(radarСoordinates1.y - radarСoordinates2.y, 2));\n        distance = distanceBetweenRadars * Math.sin(angleRadar1 / 180 * Math.PI) / Math.sin(angleThird / 180 * Math.PI);\n        return Math.abs(distance);\n      }\n    }\n\n  }\n\n  AppComponent.ɵfac = function AppComponent_Factory(t) {\n    return new (t || AppComponent)();\n  };\n\n  AppComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: AppComponent,\n    selectors: [[\"my-appqq\"]],\n    viewQuery: function AppComponent_Query(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵviewQuery(_c0, 5);\n      }\n\n      if (rf & 2) {\n        let _t;\n\n        i0.ɵɵqueryRefresh(_t = i0.ɵɵloadQuery()) && (ctx.myCanvas = _t.first);\n      }\n    },\n    decls: 5,\n    vars: 1,\n    consts: [[\"myCanvas\", \"\"], [\"class\", \"bloc\", 4, \"ngFor\", \"ngForOf\"], [1, \"bloc\"], [1, \"task\"], [1, \"\"]],\n    template: function AppComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelement(0, \"canvas\", null, 0);\n        i0.ɵɵelementStart(2, \"div\");\n        i0.ɵɵtext(3, \"asdasdasd\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(4, AppComponent_div_4_Template, 4, 1, \"div\", 1);\n      }\n\n      if (rf & 2) {\n        i0.ɵɵadvance(4);\n        i0.ɵɵproperty(\"ngForOf\", ctx.infoRadars);\n      }\n    },\n    dependencies: [i1.NgForOf],\n    encapsulation: 2\n  });\n  return AppComponent;\n})();\n\nclass InfoRadar {\n  constructor(distanceRadar, angleRadar) {\n    console.log(\"---constr start \");\n    this.distanceRadar = distanceRadar;\n    this.angleRadar = angleRadar;\n    console.log(\"---constr end \");\n  }\n\n}","map":null,"metadata":{},"sourceType":"module"}